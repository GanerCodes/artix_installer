â˜¾ <(cat << 'EOF'

â®Œ pathlib â¨¡ Path as ð©
â®Œ sys â¨¡ argv as ð”ž
ó°‹º(â€¹peggle2â€º, â›Åƒ, !) ; ó°‹º(â€¹kotsâ€º, *)

TMP_DIR = ð©("/tmp/topdf_stuff")
TMP_DIR.mkdir(parents=âœ“, exist_ok=âœ“)

âŠ¢ conv_tix(x, out=TMP_DIR / â€¹markervillecoolio.pdfâ€º):
    surround = ó°²¡â€¹ð—»âŸ¦sâ‰”â›`â‹…(xâˆ©â›`â†’ðŸƒŒ+1â†’â¤‰3)âŸ§ð—»âŸ¦xâŸ§ð—»âŸ¦sâŸ§ð—»â€º
    âŠ¢ fuz(x):
        Â¿ð©(x).existsî®¦: â†ªx
        $á´±curlâ€‰âŸ¦xâŸ§â€‰-oâ€‰âŸ¦xâ‰”TMP_DIR/â€¹âŸ¦2ó·¸»á”(ó±…)âŸ§.pngâ€ºâŸ§ó·¹¹
        â†ªx
    x = peggle2(ó°¦¥ó°¦¥ó°¦¥ó°¦¥ó°¦¥
    main = (grp âˆ¨ nrm=Æ¨(esc âˆ¨ ~â€¹([^â›â›âŸ¦]|\n)+â€º)+)*
    grp = ó°†´"âŸ¦" ~â€¹[^âŸ§]*â€º ó°†´"âŸ§"
    esc = ó°†´(~â€¹â›â›â€º) ~â€¹.â€º
    ó°¦¥ó°¦¥ó°¦¥ó°¦¥ó°¦¥)(î¸½âˆ˜x).ftrp("nrm"â­, ó°²¡Åƒ(surround(x.as_txtî®¦), e=â„µ(T=âœ“))) â›
                .ftrp("grp"â­, ó°²¡Åƒ(â€¹![](âŸ¦fuz(x.as_txtî®¦)âŸ§)â€º, e=â„µ(T=âœ“))) â›
                .as_txtî®¦
    î¸¶(Tâ‰”â€¹/tmp/markerville_template.pandocâ€º, â€¹\usepackage{pagecolor} \pagecolor{black} \color{white}â€º)
    î¸¶(fâ‰”â€¹/tmp/markerville.mdâ€º, x)
    â†ª $á´¾á´±pandocâ€‰-Hâ€‰âŸ¦TâŸ§â€‰âŸ¦fâŸ§â€‰--pdf-engine=xelatexâ€‰-Vâ€‰mainfont:JuliaMonoâ€‰-Vâ€‰monofont:JuliaMonoâ€‰-Vâ€‰sansfont:JuliaMonoâ€‰-Vâ€‰geometry:margin=0.1inâ€‰-oâ€‰âŸ¦outâŸ§ó·¹¹

âŠ¢ libre_stupid(f, o):
    $á´±lnâ€‰-sâ€‰âŸ¦f.resolveî®¦âŸ§â€‰âŸ¦X â‰” o.parent/â€¹âŸ¦o.stemâŸ§âŸ¦f.suffixâŸ§â€ºâŸ§ó·¹¹
    â†ª $á´¾á´±libreofficeâ€‰--infilter="Text (encoded):UTF8,,JuliaMono,en-US"â€‰--convert-toâ€‰pdfâ€‰âŸ¦XâŸ§â€‰--outdirâ€‰âŸ¦o.parentâŸ§ó·¹¹

R = []
aw = []
âˆ€i,xâˆˆ1ó·¸»ð”žâ†¨:
    p = ð©âˆ˜x
    R.append(o â‰” TMP_DIR/â€¹âŸ¦iâŸ§.pdfâ€º)
    sf = p.suffixâ‚ï¹•
    Â¿sfâˆˆ    "docâ€‰docx"â­: Æ’ = ðš²$á´¾á´±pandocâ€‰âŸ¦pâŸ§â€‰-fâ€‰docxâ€‰-oâ€‰âŸ¦oâŸ§ó·¹¹
    â¸˜sfâˆˆ"txtâ€‰pptxâ€‰ppt"â­: Æ’ = ðš²libre_stupid(p, o)
    â¸˜sfâˆˆ         "tix"â­: Æ’ = ðš²conv_tix(p, o)
    â¸˜sfâˆˆ         "pdf"â­: Æ’ = ðš²$á´¾á´±cpâ€‰âŸ¦pâŸ§â€‰âŸ¦oâŸ§ó·¹¹
    Â¡                  : Æ’ = ðš²$á´¾á´±img2pdfâ€‰âŸ¦pâŸ§â€‰-oâ€‰âŸ¦oâŸ§ó·¹¹
    aw.append(Æ’î®¦)
aw á´ î®¦
$á´¼á´±pdfuniteâŸ¦RâŸ—â›â€‰âŸ§âŸ¦RðŸƒŒâŸ§.cat.pdfó·¹¹

EOF
) "$@"